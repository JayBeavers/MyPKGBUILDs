# Maintainer: Det
# Contributors: Charles Ghislain, Guillaume ALAUX, Daniel J Griffiths, Jason Chu, Geoffroy Carrier, Army, kfgz, Thomas Dziedzic, Dan Serban, jjacky, EasySly

pkgname=jre
_major=7
_minor=51
_build=13
_date=18_dec_2013


_pkgver=${_major}u${_minor}
pkgver=${_major}.${_minor}
pkgrel=1
pkgdesc="Java Runtime Environment"
arch=('arm' 'armv6h')
url=http://www.oracle.com/technetwork/java/javase/downloads/index.html
license=('custom')
depends=('shared-mime-info' 'xdg-utils')
optdepends=('alsa-lib: sound'
            'ttf-dejavu: fonts')
provides=("java-runtime=$_major" "java-runtime-headless=$_major")
conflicts=("${provides[@]}")
backup=('etc/profile.d/jre.csh'
        'etc/profile.d/jre.sh')
install=jre.install

if [ "$CARCH" == "armv6h" ]; then
   file=ejre-${_major}u${_minor}-fcs-b${_build}-linux-arm-vfp-hflt-client_headless-${_date}.tar.gz
else
   file=ejre-${_major}u${_minor}-fcs-b${_build}-linux-arm-sflt-headless-${_date}.tar.gz
fi


source=("${file}"
        'jre.csh'
        'jre.sh')

md5sums=('fba114c4848c864afcea71198aebfc90'
         '92dec202858f2bf7729c6805b1bd3ae4'
         '85ba1d2b39d5e6efad89ef98d0f19909')
[ "$CARCH" = 'armv6h' ] && md5sums[0]='9b00967670f564d518486b42d12c3077'

package() {
  msg2 "Creating required dirs"
  cd ejre1.$_major.0_$_minor
  mkdir -p "$pkgdir"/{opt/java/jre,usr/share/licenses/jre,etc/{.java/.systemPrefs,profile.d}}

  msg2 "Moving stuff in place"
  mv COPYRIGHT *.txt "$pkgdir"/usr/share/licenses/jre/
  mv * "$pkgdir"/opt/java/jre/

  msg2 "Installing the scripts, confs of our own"
  cd "$srcdir"
  install -m755 jre.{,c}sh "$pkgdir"/etc/profile.d/
}
